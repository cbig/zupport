# ---------------------------------------------------------------------------
# export.py
# Created on: 2011-08-16 16:44:50.00000
#   (generated by ArcGIS/ModelBuilder)
# Usage: export <Laskenta_puusto> <Osite_field> <Output_Join_Field> <Input_Join_Field> <Target_dataset> <Geometria> <Feature_Layer> 
# Description: 
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy

# Load required toolboxes
arcpy.ImportToolbox("Model Functions")

# Script arguments
Laskenta_puusto = arcpy.GetParameterAsText(0)

Osite_field = arcpy.GetParameterAsText(1)

Output_Join_Field = arcpy.GetParameterAsText(2)

Input_Join_Field = arcpy.GetParameterAsText(3)

Target_dataset = arcpy.GetParameterAsText(4)

Geometria = arcpy.GetParameterAsText(5)

Feature_Layer = arcpy.GetParameterAsText(6)

# Local variables:
Osite = Laskenta_puusto
Output_Table = Laskenta_puusto
Geomteria_join = Output_Table
Output_Features = Geomteria_join

# Process: Iterate Osite Values
arcpy.IterateFieldValues_mb(Laskenta_puusto, Osite_field, "String", "true", "false", "0")

# Process: Remove Join
arcpy.RemoveJoin_management("", "XFOREST_SOSLASPSTO_TableSele")

# Process: Table Select
arcpy.TableSelect_analysis(Laskenta_puusto, Output_Table, "\"%Osite field%\"=%Osite%")

# Process: Add Join
arcpy.AddJoin_management(Geometria, Input_Join_Field, Output_Table, Output_Join_Field, "KEEP_COMMON")

# Process: Append
arcpy.Append_management("''", Target_dataset, "TEST", "", "")

